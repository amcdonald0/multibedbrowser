<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Login - Multi-Bed Browser</title>
    
   <!-- Bootstrap CSS -->
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
   <link rel="stylesheet" href="shared_css.css">
   <!-- Font Awesome -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
   <!-- Google Fonts -->
   <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Source+Code+Pro&display=swap" rel="stylesheet">
   
  </head>
  <body>
    <!-- Navigation Bar -->
   <nav class="navbar navbar-expand-lg navbar-dark">
    <a class="navbar-brand" href="home.html"><i class="fas fa-dna helix-icon"></i> Multi-Bed Browser</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
      </li>
      <li class="nav-item">
        <a class="nav-link" href="home.html"><i class="fas fa-home"></i> Home</a>
      </li>
        <li class="nav-item">
          <a class="nav-link" href="upload.html"><i class="fas fa-upload"></i> Upload</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="search.html"><i class="fas fa-search"></i> Search</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="users.html"><i class="fas fa-users"></i> Users</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="help.html"><i class="fas fa-question-circle"></i> Help</a>
        </li>
      </ul>
      <div class="ml-auto">
        <a class="btn btn-dark" href="login.html">
          <i class="fas fa-sign-in-alt"></i> Login
        </a>
      </div>
    </div>
  </nav> 

    <!-- Login Form Container -->
    <div class="container login-container">
        <h2 class="text-center mb-4">Sign In</h2>
        
        <form class="login-form">
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" class="form-control" id="username" name="username" required 
                       placeholder="Enter your username">
                <div class="error-message" id="username-error"></div>
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" class="form-control" id="email" name="email" required 
                       placeholder="Enter your email">
                <div class="error-message" id="email-error"></div>
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" class="form-control" id="password" name="password" required 
                       placeholder="Enter your password">
                <div class="error-message" id="password-error"></div>
            </div>

            <div class="form-group">
                <label for="role">Role</label>
                <select class="form-control" id="role" name="role" required>
                    <option value="">Select a role</option>
                    <option value="user">User</option>
                    <option value="admin">Admin</option>
                </select>
                <div class="error-message" id="role-error"></div>
            </div>

            <button type="submit" class="btn btn-primary btn-block">Sign In</button>

            <div class="divider">
                <span>or</span>
            </div>

            <button type="button" class="btn btn-secondary btn-block" onclick="continueAsGuest()">
                Continue As Guest
            </button>
        </form>
    </div>

    <script>
        document.querySelector('.login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Basic form validation
            const username = document.getElementById('username').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const role = document.getElementById('role').value;
            let isValid = true;

            // Clear previous error messages and validation states
            document.querySelectorAll('.error-message').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.form-control').forEach(el => el.classList.remove('is-invalid'));

            // Username validation
            if (!username) {
                document.getElementById('username-error').textContent = 'Please enter your username';
                document.getElementById('username-error').style.display = 'block';
                document.getElementById('username').classList.add('is-invalid');
                isValid = false;
            } else if (username.length < 3) {
                document.getElementById('username-error').textContent = 'Username must be at least 3 characters long';
                document.getElementById('username-error').style.display = 'block';
                document.getElementById('username').classList.add('is-invalid');
                isValid = false;
            }

            // Email validation
            if (!email) {
                document.getElementById('email-error').textContent = 'Please enter your email address';
                document.getElementById('email-error').style.display = 'block';
                document.getElementById('email').classList.add('is-invalid');
                isValid = false;
            } else if (!isValidEmail(email)) {
                document.getElementById('email-error').textContent = 'Please enter a valid email address';
                document.getElementById('email-error').style.display = 'block';
                document.getElementById('email').classList.add('is-invalid');
                isValid = false;
            }

            // Password validation
            if (!password) {
                document.getElementById('password-error').textContent = 'Please enter your password';
                document.getElementById('password-error').style.display = 'block';
                document.getElementById('password').classList.add('is-invalid');
                isValid = false;
            } else if (password.length < 6) {
                document.getElementById('password-error').textContent = 'Password must be at least 6 characters long';
                document.getElementById('password-error').style.display = 'block';
                document.getElementById('password').classList.add('is-invalid');
                isValid = false;
            }

            // Role validation
            if (!role) {
                document.getElementById('role-error').textContent = 'Please select your role';
                document.getElementById('role-error').style.display = 'block';
                document.getElementById('role').classList.add('is-invalid');
                isValid = false;
            }

            if (isValid) {
                // Create form data object
                const formData = {
                    username: username,
                    email: email,
                    password: password,
                    role: role
                };

                // Here you would typically send the form data to your server
                console.log('Form data:', formData);
                
                // Store user data in localStorage
                localStorage.setItem('username', formData.username);
                localStorage.setItem('role', formData.role);
                
                // Redirect to welcome page with query parameters
                window.location.href = `welcome_user.html?username=${encodeURIComponent(formData.username)}&role=${encodeURIComponent(formData.role)}`;
            }
        });

        function continueAsGuest() {
            console.log('Continuing as guest');
            window.location.href = 'home.html';
        }

        function isValidEmail(email) {
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailPattern.test(email);
        }

        // Real-time validation
        document.querySelectorAll('.form-control').forEach(input => {
            input.addEventListener('input', function() {
                // Clear error message when user starts typing
                const errorElement = document.getElementById(`${this.id}-error`);
                if (errorElement) {
                    errorElement.style.display = 'none';
                }
                this.classList.remove('is-invalid');
            });
        });
    </script>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>
  </body>
</html>